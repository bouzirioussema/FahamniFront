import{a as N,c as L,f as k,j as A,k as F,l as H,q as z}from"./chunk-4JW6JOM3.js";import{$ as x,$b as y,Ka as a,La as C,Xa as m,Yb as P,Za as c,Zb as v,_b as E,ab as t,ac as w,bb as n,fc as T,gb as f,gc as I,hb as u,lb as i,mb as p,pb as b,qb as h,rb as _,tb as M,vb as S,wb as O}from"./chunk-TON6CJEA.js";function W(r,d){r&1&&(t(0,"div",17),i(1,"Loading subscriptions..."),n())}function D(r,d){if(r&1&&(t(0,"div",18),i(1),n()),r&2){let e=u();a(),p(e.error)}}function Y(r,d){if(r&1&&(t(0,"tr")(1,"td"),i(2),n(),t(3,"td"),i(4),n(),t(5,"td",21)(6,"span",22),i(7),n()(),t(8,"td"),i(9),n(),t(10,"td"),i(11),S(12,"date"),n()()),r&2){let e=d.$implicit,s=u(2);a(2),p(e.username),a(2),p(e.email),a(2),c("ngClass",s.getPlanClass(e.plan)),a(),p(s.getPlanLabel(e.plan)),a(2),p(e.amountLabel),a(2),p(O(12,6,e.createdAt,"short"))}}function j(r,d){if(r&1&&(t(0,"table",19)(1,"thead")(2,"tr")(3,"th"),i(4,"User"),n(),t(5,"th"),i(6,"Email"),n(),t(7,"th"),i(8,"Plan"),n(),t(9,"th"),i(10,"Amount"),n(),t(11,"th"),i(12,"Date"),n()()(),t(13,"tbody"),m(14,Y,13,9,"tr",20),n()()),r&2){let e=u();a(14),c("ngForOf",e.filteredSubscriptions)}}function B(r,d){r&1&&(t(0,"div",17),i(1," No subscriptions found. "),n())}var K=(()=>{class r{http;subscriptions=[];filteredSubscriptions=[];loading=!1;error="";searchTerm="";selectedPlan="ALL";apiUrl="http://localhost:8082/api";constructor(e){this.http=e}ngOnInit(){this.loadSubscriptions()}getHeaders(){let e=localStorage.getItem("jwtToken");return new T({Authorization:`Bearer ${e}`,"Content-Type":"application/json"})}loadSubscriptions(){this.loading=!0,this.error="",this.http.get(`${this.apiUrl}/admin/subscriptions`,{headers:this.getHeaders()}).subscribe({next:e=>{this.subscriptions=e,this.filterSubscriptions(),this.loading=!1},error:()=>{this.error="Failed to load subscriptions",this.loading=!1}})}onSearchChange(){this.filterSubscriptions()}onPlanFilterChange(){this.filterSubscriptions()}filterSubscriptions(){let e=this.searchTerm.toLowerCase();this.filteredSubscriptions=this.subscriptions.filter(s=>{let o=!e||s.username&&s.username.toLowerCase().includes(e)||s.email&&s.email.toLowerCase().includes(e),g=this.selectedPlan==="ALL"||s.plan===this.selectedPlan;return o&&g})}getPlanLabel(e){if(!e)return"\u2014";switch(e){case"ONE_MONTH":return"1 mois";case"SIX_MONTHS":return"6 mois";case"ONE_YEAR":return"1 an";default:return e}}getPlanClass(e){switch(e){case"ONE_MONTH":return"badge-plan-one-month";case"SIX_MONTHS":return"badge-plan-six-months";case"ONE_YEAR":return"badge-plan-one-year";default:return"badge-plan-default"}}static \u0275fac=function(s){return new(s||r)(C(I))};static \u0275cmp=x({type:r,selectors:[["app-subscriptions"]],standalone:!0,features:[M],decls:26,vars:6,consts:[[1,"subscriptions-section"],[1,"subscriptions-header"],[1,"subtitle"],[1,"subscriptions-toolbar"],[1,"toolbar-inner"],[1,"search-group"],[1,"material-icons","search-icon"],["type","text","placeholder","Search users...",3,"ngModelChange","input","ngModel"],[1,"filter-group"],["id","planFilter",3,"ngModelChange","change","ngModel"],["value","ALL"],["value","ONE_MONTH"],["value","SIX_MONTHS"],["value","ONE_YEAR"],["class","info-text",4,"ngIf"],["class","error-text",4,"ngIf"],["class","subscriptions-table",4,"ngIf"],[1,"info-text"],[1,"error-text"],[1,"subscriptions-table"],[4,"ngFor","ngForOf"],[1,"plan-cell"],[1,"badge",3,"ngClass"]],template:function(s,o){s&1&&(t(0,"section",0)(1,"div",1)(2,"h2"),i(3,"Subscriptions Management"),n(),t(4,"p",2),i(5,"User subscriptions overview"),n()(),t(6,"div",3)(7,"div",4)(8,"div",5)(9,"span",6),i(10,"search"),n(),t(11,"input",7),_("ngModelChange",function(l){return h(o.searchTerm,l)||(o.searchTerm=l),l}),f("input",function(){return o.onSearchChange()}),n()(),t(12,"div",8)(13,"select",9),_("ngModelChange",function(l){return h(o.selectedPlan,l)||(o.selectedPlan=l),l}),f("change",function(){return o.onPlanFilterChange()}),t(14,"option",10),i(15,"All Plans"),n(),t(16,"option",11),i(17,"1 Month"),n(),t(18,"option",12),i(19,"6 Months"),n(),t(20,"option",13),i(21,"1 Year"),n()()()()(),m(22,W,2,0,"div",14)(23,D,2,1,"div",15)(24,j,15,1,"table",16)(25,B,2,0,"div",14),n()),s&2&&(a(11),b("ngModel",o.searchTerm),a(2),b("ngModel",o.selectedPlan),a(9),c("ngIf",o.loading),a(),c("ngIf",!o.loading&&o.error),a(),c("ngIf",!o.loading&&!o.error&&o.filteredSubscriptions.length),a(),c("ngIf",!o.loading&&!o.error&&!o.filteredSubscriptions.length))},dependencies:[w,P,v,E,y,z,F,H,N,A,L,k],styles:[".subscriptions-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f9fafb,#eef2ff 40%,#fff);padding:24px 28px;border-radius:12px;box-shadow:0 18px 45px #0f172a1f}.subscriptions-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;margin-bottom:20px}.subscriptions-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600}.subscriptions-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px}.subscriptions-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:20px}.toolbar-inner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex-wrap:nowrap}.search-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:6px 10px;border-radius:9999px;background-color:#ffffffe6;border:1px solid #e5e7eb;flex:0 1 260px}.search-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;background:transparent;width:100%}.search-icon[_ngcontent-%COMP%]{font-size:18px;color:#9ca3af}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:#4b5563}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:6px 14px;border-radius:9999px;border:1px solid #e5e7eb;background-color:#f9fafb;cursor:pointer}.subscriptions-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}.subscriptions-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#ffffffd9}.subscriptions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .subscriptions-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;border-bottom:1px solid #e5e7eb;text-align:left}.plan-cell[_ngcontent-%COMP%]{text-align:center}.subscriptions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;color:#4b5563;text-transform:uppercase;font-size:12px}.subscriptions-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f3f4ff}.subscriptions-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0e7ff;transform:translateY(-1px);transition:background-color .15s ease,transform .15s ease}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:2px 8px;border-radius:9999px;font-size:12px;font-weight:500}.badge-plan-one-month[_ngcontent-%COMP%]{background-color:#ecfdf5;color:#16a34a}.badge-plan-six-months[_ngcontent-%COMP%]{background-color:#fef2f2;color:#ef4444}.badge-plan-one-year[_ngcontent-%COMP%]{background-color:#eff6ff;color:#2563eb}.badge-plan-default[_ngcontent-%COMP%]{background-color:#e5e7eb;color:#4b5563}.info-text[_ngcontent-%COMP%]{margin-top:12px;color:#6b7280}.error-text[_ngcontent-%COMP%]{margin-top:12px;color:#dc2626}"]})}return r})();export{K as SubscriptionsComponent};
